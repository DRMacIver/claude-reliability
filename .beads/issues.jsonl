{"id":"claude-reliability-0ue","title":"Stop hook message has incorrect numbering (1, 3, 4 - missing step 2)","status":"closed","priority":2,"issue_type":"bug","owner":"david@drmaciver.com","created_at":"2026-01-20T12:03:02.712947885Z","created_by":"David R. MacIver","updated_at":"2026-01-20T14:30:11.730878125Z","closed_at":"2026-01-20T14:30:11.730878125Z","close_reason":"Closed"}
{"id":"claude-reliability-598","title":"Block JKW mode exit if outstanding beads issues exist","status":"closed","priority":2,"issue_type":"feature","owner":"david@drmaciver.com","created_at":"2026-01-20T22:39:15.546341258Z","created_by":"David R. MacIver","updated_at":"2026-01-20T22:48:46.933131092Z","closed_at":"2026-01-20T22:48:46.933131092Z","close_reason":"Closed"}
{"id":"claude-reliability-7b0","title":"Investigate missing reflection prompt before stop","description":"When Claude stopped working on a task without completing the user's request (wrote tests but didn't run them to generate real transcripts, tried to manually write transcript.jsonl files instead), the stop hook allowed the exit after the uncommitted changes were committed. There should have been a reflection prompt asking 'Have you actually done what the user asked?' but it did not appear. Need to investigate why this prompt didn't fire or if it needs to be more prominent.","notes":"Analysis: Reflection check (line 273) runs AFTER git checks. When Claude commits AND pushes in one command, the hook goes from 'uncommitted' to 'clean' without a stop in between. Reflection uses current git state which is now false. FIX: Track 'had_changes_this_session' flag when blocking on uncommitted changes.","status":"closed","priority":1,"issue_type":"bug","owner":"david@drmaciver.com","created_at":"2026-01-20T09:54:20.506855639Z","created_by":"David R. MacIver","updated_at":"2026-01-20T14:18:29.902518008Z","closed_at":"2026-01-20T14:18:29.902518008Z","close_reason":"Fixed: Added 'had_uncommitted_changes' marker to track when we blocked on uncommitted changes. Reflection now uses this marker instead of only checking current git state, ensuring reflection runs even if Claude commits+pushes in one command."}
{"id":"claude-reliability-99v","title":"Refactor main.rs to be thin wrapper (currently 167 lines, max 50)","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-19T14:04:00.328448Z","created_by":"drmaciver","updated_at":"2026-01-20T14:14:20.606532421Z","closed_at":"2026-01-20T14:14:20.606532421Z","close_reason":"Already fixed - main.rs is 27 lines (under 50 line limit)"}
{"id":"claude-reliability-9w1","title":"Add startup message explaining claude-reliability mode","status":"closed","priority":2,"issue_type":"feature","owner":"david@drmaciver.com","created_at":"2026-01-20T22:40:14.965976132Z","created_by":"David R. MacIver","updated_at":"2026-01-20T22:54:19.781966135Z","closed_at":"2026-01-20T22:54:19.781966135Z","close_reason":"Closed"}
{"id":"claude-reliability-a39","title":"Stop hook allows exit with unstaged changes","description":"The stop hook did not block exit when there were unstaged changes in the repository. The agent was able to stop twice and exit without committing changes. The uncommitted changes hook check may not be running correctly, or there may be a path/cwd issue causing git status to fail.","status":"closed","priority":1,"issue_type":"bug","owner":"david@drmaciver.com","created_at":"2026-01-21T11:16:06.637513138Z","created_by":"David R. MacIver","updated_at":"2026-01-21T11:29:11.136382501Z","closed_at":"2026-01-21T11:29:11.136382501Z","close_reason":"Closed"}
{"id":"claude-reliability-c9q","title":"Reflection hook should not fire when agent asks a question","description":"The reflection stop hook fired even though the agent asked a question to the user.\n\nThe reflection check happens at the end of the stop hook flow, but it should be skipped if the agent's last output was a question. Currently, the code checks for questions earlier in the flow (for sub-agent decision), but the reflection check at the end doesn't consider whether the agent was asking a question.\n\nExpected: If agent asks a question, allow stop without reflection prompt\nActual: Reflection prompt fires even when agent asked a question","status":"in_progress","priority":2,"issue_type":"bug","owner":"david@drmaciver.com","created_at":"2026-01-21T06:11:17.104356006Z","created_by":"David R. MacIver","updated_at":"2026-01-21T11:44:04.448698262Z"}
{"id":"claude-reliability-cxi","title":"Stop hook shows push instruction when repo has no remote (require_push should be false)","status":"closed","priority":2,"issue_type":"bug","owner":"david@drmaciver.com","created_at":"2026-01-20T12:03:08.167038388Z","created_by":"David R. MacIver","updated_at":"2026-01-20T14:30:16.913349335Z","closed_at":"2026-01-20T14:30:16.913349335Z","close_reason":"Closed"}
{"id":"claude-reliability-i6d","title":"Create comprehensive snapshot tests for all stop hook states","description":"Snapshot tests for stop hook states have been implemented.\n\n## Implemented Tests\n\n1. **stop-hook-fast-path-clean** - Tests the fast path exit when repo is clean\n2. **stop-hook-uncommitted-changes** - Tests blocking on uncommitted changes\n3. **stop-hook-reflection-first-stop** - Tests first reflection prompt (sets marker)\n4. **stop-hook-reflection-second-stop** - Tests second stop (clears marker, allows exit)\n\n## Deferred Tests\n\nThe following scenarios are better tested via unit tests rather than snapshot tests because they require specific Claude behavior or simulated conditions:\n\n- Exit phrases (HUMAN_INPUT_REQUIRED, PROBLEM_NEEDS_USER)\n- API error loops\n- JKW mode states (staleness, all done, work remains)\n- Sub-agent question decisions\n- Validation failures\n- Unpushed commits (Claude keeps trying and eventually pushes)\n\nThese complex scenarios are covered by unit tests in `src/hooks/stop.rs`.","status":"closed","priority":2,"issue_type":"feature","owner":"david@drmaciver.com","created_at":"2026-01-20T22:42:00.336404834Z","created_by":"David R. MacIver","updated_at":"2026-01-21T11:43:39.621866917Z","closed_at":"2026-01-21T11:43:39.621866917Z","close_reason":"Closed"}
{"id":"claude-reliability-q1n","title":"Stop hooks not running in snapshot test --print mode","status":"closed","priority":1,"issue_type":"bug","owner":"david@drmaciver.com","created_at":"2026-01-20T11:39:24.562969048Z","created_by":"David R. MacIver","updated_at":"2026-01-20T12:00:14.90913646Z","closed_at":"2026-01-20T12:00:14.90913646Z","close_reason":"Closed"}

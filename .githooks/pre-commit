#!/usr/bin/env bash
# Pre-commit hook that runs all checks
#
# This hook is used when core.hooksPath is set to .githooks/

set -e

# Get the directory where this script is located
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Run our custom checks (only in Claude Code sessions)
if [ -n "$CLAUDECODE" ]; then
    # Check capability version bumps
    if [ -x "$SCRIPT_DIR/check-capability-version.sh" ]; then
        "$SCRIPT_DIR/check-capability-version.sh" || exit 1
    fi

    # Check hook edits
    if [ -x "$SCRIPT_DIR/check-hook-edits.sh" ]; then
        "$SCRIPT_DIR/check-hook-edits.sh" || exit 1
    fi
fi

exit 0
